<app-retailer-layout></app-retailer-layout>
<div id="main-content">
  <div class="block-header">
    <div class="row clearfix">
      <div class="col-md-6 col-sm-12">
        <h2>Money Transfer </h2>
      </div>
      <div class="col-md-6 col-sm-12 text-right">
        

      </div>
    </div>
  </div>

  <div class="container-fluid">
    <div class="row clearfix">
      <div class="col-lg-2"></div>
      <div class="col-lg-8 col-sm-12">
        <div class="card">
         
          <div class="card-body  pt-2 pb-1">
          
            <div class="mt-1">
              <div class="card-body">
                <div class="wrapper-form-money-transfer text-center">
                  <div class="row">
                    <div class="col-sm-12">
                      <div class="option-control-money-search">
                        <div class="row">
                          <div class="col-12">
                            <ul class="nav nav-pills nav-justified nav-tab-money" role="tablist">
                              <li class="nav-item waves-effect waves-light">
                                <a class="nav-link active" data-toggle="tab" href="javascript:void(0)"
                                  (click)="updateTransferType('mobile')" role="tab" aria-selected="true">
                                  <span class="d-none d-md-block">Mobile Number</span><span
                                    class="d-block d-md-none"><i class="mdi mdi-phone-outline h5"></i>
                                    Mobile Number</span>
                                </a>
                              </li>
                              <li class="nav-item waves-effect waves-light">
                                <a class="nav-link" data-toggle="tab" href="javascript:void(0)"
                                  (click)="updateTransferType('account')" role="tab" aria-selected="false">
                                  <span class="d-none d-md-block">Bank Account Number</span><span
                                    class="d-block d-md-none"><i class="mdi mdi-account h5"></i> Account
                                    Number</span>
                                </a>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row wrapper-control-mobile-transfer">
                    <div class="col-sm-12">
                      <form (ngSubmit)="f.form.valid && onSubmit()" #f="ngForm" name="form">
                        <div class="form-group mt-3">
                          <input type="text" class="form-control w-80 enable_right_click" name="mobileNo" autofocus
                            *ngIf="transferType == 'mobile'" maxlength="10" minlength="10"
                            [(ngModel)]="moduleM.mobileNo" #mobileNo="ngModel" [ngClass]="{
                                        'is-invalid': f.submitted && mobileNo.invalid
                                      }" required placeholder="Mobile Number" (keyup)="
                                        updateMobile($event); validateMobile($event)
                                      " />
                          <input type="text" class="form-control w-80 enable_right_click" name="mobileNo" autofocus
                            *ngIf="transferType == 'account'" maxlength="18" minlength="8"
                            [(ngModel)]="moduleM.mobileNo" #mobileNo="ngModel" [ngClass]="{
                                        'is-invalid': f.submitted && mobileNo.invalid
                                      }" required placeholder="Account  Number" (keyup)=" updateMobile($event);
                                        validateAccount($event)
                                      " />
                        </div>
                        <span class="mt-3 error-msg" *ngIf="(proper == true)">Please enter valid
                          {{transferType=='mobile'?'Mobile':'Account'}}. </span>
                        <br>
                        <button *ngIf="transferType == 'account'" type="submit" [disabled]="moduleM.mobileNo?.length<7"
                          class="btn btn-primary">SEARCH</button>

                        <button *ngIf="transferType == 'mobile'" type="submit" [disabled]="moduleM.mobileNo?.length<10"
                          class="btn btn-primary">SEARCH</button>

                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="card" *ngIf="displayAddForm">
              <div class="card-header text-dark">New Sender Registration</div>
              <form (ngSubmit)="fr.form.valid && addRemitter()" #fr="ngForm" name="form" pFocusTrap autocomplete="off">
                <div class="card-body">
                  <div class="row mt-3">
                    <div class="col-sm-6">
                      <div class="form-group">
                        <label>Sender Mobile Number<span class="mandatory">*</span></label>
                        <input type="text" disabled class="form-control" name="mobileNo" [(ngModel)]="moduleM.mobileNo"
                          #mobileNo="ngModel" [ngClass]="{
                                      'is-invalid': fr.submitted && mobileNo.invalid
                                    }" required placeholder="Sender Mobile Number" />
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <div class="form-group">
                        <label>Fist Name<span class="mandatory">*</span></label>
                        <input type="text" OnlyCharacter maxlength="50" class="form-control" name="remitterFName" [minlength]="3"
                          [(ngModel)]="moduleM.remitterFName" #remitterFName="ngModel" [ngClass]="{
                                      'is-invalid': fr.submitted && remitterFName.invalid
                                    }" required placeholder="First Name" />
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <div class="form-group">
                        <label>Last Name<span class="mandatory">*</span></label>
                        <input OnlyCharacter type="text" maxlength="50" [minlength]="3" class="form-control" name="remitterName"
                          [(ngModel)]="moduleM.remitterLName" #remitterLName="ngModel" [ngClass]="{
                                      'is-invalid': fr.submitted && remitterLName.invalid
                                    }" required placeholder="Last Name" />
                      </div>
                    </div>
                    <div class="col-sm-6"  *ngIf="0">
                      <div class="form-group">
                        <label>Date of Birth <span class="mandatory">*</span></label>
                        <input type="date" class="form-control" [ngClass]="{
                                      'is-invalid': fr.submitted && dob.invalid
                                    }" required name="dob" [(ngModel)]="moduleM.dob" #dob="ngModel"
                          placeholder="DOB" />
                      </div>
                    </div>
                    <div class="col-sm-12" *ngIf="0">
                      <div class="form-group">
                        <label>Address <span class="mandatory">*</span> </label>
                        <input maxlength="200" type="text" class="form-control" [ngClass]="{
                                      'is-invalid': fr.submitted && address.invalid
                                    }" name="address" required [(ngModel)]="moduleM.address" #address="ngModel"
                          placeholder="Address" />
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <span class="mt-3 error-msg" *ngIf="(proper == true)">Please Enter Valid Last Name </span>
                      <div class="form-group" *ngIf="!isliven">
                        <label>OTP<span class="mandatory">*</span></label>
                        <div class="row">
                          <div class="col-sm-6 pr-0">
                            <input type="text"  class="form-control" name="otp" [(ngModel)]="moduleM.otp" #otp="ngModel"
                              [ngClass]="{
                                          'is-invalid': fr.submitted && otp.invalid
                                        }" required placeholder="OTP" />
                          </div>
                          <div class="col-sm-6 pt-2">
                            <a href="javascript:void(0)" (click)="OtpRsend()" class="btn btn-outline-info">Resend
                              OTP</a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row" *ngIf="0">
                    <div class="col-sm-4">
                      <div class="form-group">
                        <label>Zip Code <span class="mandatory">*</span></label>
                        <input type="text" class="form-control" name="ZipCode" OnlyNumber minlength="6" maxlength="6"
                          [ngClass]="{
                                      'is-invalid': fr.submitted && zipCode.invalid
                                    }" required [(ngModel)]="moduleM.zipCode" #zipCode="ngModel" placeholder="Zip" />
                      </div>
                    </div>                   
                  </div>
                  <div class="row">
                    <div class="col-12 text-center">
                      <button type="submit" class="btn btn-outline-info">
                        {{ isliven == true ? "Send OTP" : "SUBMIT" }}
                      </button> 
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div class="card p-card" *ngIf="displaySearchList">
              <p-table class="table-rt table-remitter-wrapper" #dt [value]="remitterList" dataKey="remitterId"
                [rowHover]="true" [rows]="200" [showCurrentPageReport]="true" [loading]="commonService.isLoader"
                [paginator]="false" currentPageReportTemplate="{first} - {last} of {totalRecords}"
                [filterDelay]="0" [globalFilterFields]="[
                            'RemitterId',
                            'RemitterName',
                            'MobileNo',
                            'BeneficiaryAcc',
                            'BankitLimit'
                          ]">
                <ng-template pTemplate="caption">
                  <div class="row table-header">
                    <div class="col-sm-6 col-md-8 p-d-flex">
                      <h6>Sender Details</h6>
                    </div>
                    <div class="col-sm-6 col-md-4 text-right">
                      <i class="pi pi-search" style="margin: 4px 4px 0 0"></i>
                      <input pInputText class="form-control" type="text" (input)="
                                    dt.filterGlobal(
                                      changeText($event.currentTarget),
                                      'contains'
                                    )
                                  " placeholder="Global Search" />
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="header">
                  <tr>
                    <th>S.R.</th>
                    <th pSortableColumn="RemitterName">
                      <div class="p-d-flex p-jc-between p-ai-center">
                        Sender Name
                        <p-sortIcon field="RemitterName"></p-sortIcon>
                      </div>
                    </th>
                    <th pSortableColumn="MobileNo">
                      <div class="p-d-flex p-jc-between p-ai-center">
                        Mobile Number
                        <p-sortIcon field="MobileNo"></p-sortIcon>
                      </div>
                    </th>
                    <th pSortableColumn="BeneficiaryAcc">
                      <div class="p-d-flex p-jc-between p-ai-center">
                        Account Number
                        <p-sortIcon field="BeneficiaryAcc"></p-sortIcon>
                      </div>
                    </th>
                    <th pSortableColumn="BankitLimit">
                      <div class="p-d-flex p-jc-between p-ai-center">
                        Limit
                        <p-sortIcon field="BankitLimit"></p-sortIcon>
                      </div>
                    </th>
                    <th>Action</th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-cp let-i="rowIndex">
                  <tr class="p-selectable-row">
                    <td>{{ i + 1 }}.</td>
                    <td class="rem-name">
                      {{ cp.RemitterName }}
                    </td>
                    <td>
                      {{ cp.MobileNo }}
                    </td>
                    <td class="rem-account">{{ cp.BeneficiaryAcc }}</td>
                    <td>
                      <ng-container *ngIf="!paymentMode">
                        {{ cp.PaySprintLimit }}
                      </ng-container>
                      <ng-container *ngIf="paymentMode">
                        {{ cp.RazorLimit }}
                      </ng-container>
                    </td>
                    <td>
                      <button (click)="onBeneficiaryView(cp)" type="button" class="btn btn-outline-info btn-sm w-20">
                        View
                      </button>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr>
                    <td colspan="6">No records found.</td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-2"></div>
    </div>
  </div>
</div>